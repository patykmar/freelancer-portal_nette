<?php/** * Description of MojeFakturaControl * * @author patykmar */namespace App\Components\MojeFaktura;use App\Config\AppParameterService;use App\Factory\MPdfFactory;use App\Model\FakturaModel;use App\Model\FakturaPolozkaModel;use Mpdf\Mpdf;use Mpdf\MpdfException;use Nette\Application\UI\Control;class MojeFakturaControl extends Control{    public const string SAVE_AS_FILE = "F";    public const string INLINE = "I";    private mPDF $mPDF;    private FakturaModel $fakturaModel;    private FakturaPolozkaModel $fakturaPolozkaModel;    private AppParameterService $appParameterService;    /**     * @throws MpdfException     */    public function __construct(        FakturaModel        $fakturaModel,        FakturaPolozkaModel $fakturaPolozkaModel,        MPdfFactory         $pdfFactory,        AppParameterService $appParameterService    )    {        $this->mPDF = $pdfFactory->create();        $this->fakturaModel = $fakturaModel;        $this->fakturaPolozkaModel = $fakturaPolozkaModel;        $this->appParameterService = $appParameterService;    }    /**     * Exports Invoice template via passed mPDF.     *     * @param int $invoiceId     * @return void     * @throws MpdfException     */    public function exportToPdf(int $invoiceId): void    {        $fakturaData = $this->fakturaModel->fetchWithName($invoiceId);        $fakturaPolozky = $this->fakturaPolozkaModel->fetchAllByIdFaktura($invoiceId);        $pdfFileName = $this->appParameterService->getBasePath() . "/facka/" . $fakturaData['pdf_soubor'];        $fa_zahlavi = clone $this->template;        $fa_zapati = clone $this->template;        $fa_inicialy = clone $this->template;        $fa_telo = clone $this->template;        $fa_cena_celkem_razitko = clone $this->template;        $fa_zahlavi->setFile(__DIR__ . '/fa_zahlavi.latte');        $fa_zapati->setFile(__DIR__ . '/fa_zapati.latte');        $fa_telo->setFile(__DIR__ . '/fakturaBezDph.latte');        $fa_inicialy->setFile(__DIR__ . '/fa_inicialy.latte');        $fa_cena_celkem_razitko->setFile(__DIR__ . '/fa_cena_celkem_razitko.latte');        $fa_zahlavi->title = $fakturaData['title'];        $fa_inicialy->faktura = $fakturaData;        $fa_telo->fakturaPolozky = $fakturaPolozky;        $fa_cena_celkem_razitko->faktura = $fakturaData;        #template->render();        #exit;        #$this->generate($template);        // Define the Header/Footer before writing anything so they appear on the first page        $this->mPDF->SetHTMLHeader((string)$fa_zahlavi);        $this->mPDF->SetHTMLFooter((string)$fa_zapati);        $this->mPDF->WriteHTML((string)$fa_inicialy);        $this->mPDF->WriteHTML((string)$fa_telo);        $this->mPDF->WriteHTML((string)$fa_cena_celkem_razitko);//        $this->mPDF->Output($pdfFileName, self::SAVE_AS_FILE);        $this->mPDF->Output('', self::INLINE);    }}